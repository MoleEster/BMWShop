define("ds2-electric-range-tracking",["jquery","ds2-tracking-base","ds2-tracking"],function(d,f,g){d.widget("digitals2.ds2TrackingELectricRange",f,{_initialize:function(a){this._super(a)},_create:function(){var a=this,b=d(a.element);a.count=0;a.mmdr="";a.linkedProduct=[];a.solutionSpecific=a.solutionSpecificDefault={};a.trackingComponent=a._getTrackingComponentData(b);a.trackingProducts=a._getTrackingProducts(b);a._addProductsToGlobalTracking(a.trackingProducts);b.on("ds2-electric-range--event-tracking",
function(b){a._trackEvents(b)});b.on("ds2-electric-range--update-tracking",function(b){a._updateProductData(b)});return a._super()},_updateProductData:function(a){a=a.detail;a.mmdr&&(this.mmdr=a.mmdr);a.linkedProduct&&(this.linkedProduct=a.linkedProduct);a.solutionSpecific&&(this.solutionSpecific=a.solutionSpecific);a.solutionSpecificDefault&&(this.solutionSpecificDefault=a.solutionSpecificDefault)},_trackEvents:function(a){var b=a.detail,c=b.element?d(b.element):d(this.element),e=this._getTrackingOptionsData(c);
e=e?e:{name:"electric-range",content:{active:!0}};trackingEvent=(trackingEvent=this._getTrackingEventData(c))?trackingEvent:{eventInfo:{eventName:"",eventAction:"",eventPoints:"",type:"",effect:"",cause:""},category:{primaryCategory:"",subCategory1:"",subCategory2:""}};eventInfo=b.eventInfo?b.eventInfo:{};category=b.category?b.category:{};attributes=b.attributes?b.attributes:{};e&&trackingEvent&&(0===this.count?(eventInfo.eventName="automatic",this.count+=1):eventInfo.eventName=eventInfo.eventName?
eventInfo.eventName:trackingEvent.eventInfo.eventName||"interaction",eventInfo.eventAction=eventInfo.eventAction?eventInfo.eventAction:trackingEvent.eventInfo.eventAction||"internal click",eventInfo.eventPoints=eventInfo.eventPoints?eventInfo.eventPoints:trackingEvent.eventInfo.eventPoints||"na",eventInfo.type=eventInfo.type?eventInfo.type:trackingEvent.eventInfo.type||"success",eventInfo.effect=eventInfo.effect?eventInfo.effect:trackingEvent.eventInfo.effect||"nsc \x3e modell selected",eventInfo.cause=
eventInfo.cause?eventInfo.cause:trackingEvent.eventInfo.cause||"default",this.trackingComponent&&(category.primaryCategory=category.primaryCategory?category.primaryCategory:trackingEvent.category.primaryCategory||this.trackingComponent.componentInfo.componentName),category.subCategory1=category.subCategory1?category.subCategory1:trackingEvent.category.subCategory1||"na",category.subCategory2=category.subCategory2?category.subCategory2:trackingEvent.category.subCategory2||"na",attributes.requestedURL=
attributes.requestedURL?attributes.requestedURL:"na",this.trackingComponent&&(attributes.linkedComponent=[{componentInfo:this.trackingComponent.componentInfo.componentID}]),attributes.linkedPage={pageInfo:"na"},attributes.linkedProduct=this.linkedProduct||"na",e=this.bmwTrackOptionsBuilder.options().name(trackingEvent.eventInfo.track||e.name||"").build(),b=this._populateClickEvent(a,e.name,eventInfo.target,eventInfo.eventName,eventInfo.cause,eventInfo.effect),b.eventInfo.eventAction=eventInfo.eventAction,
b.eventInfo.eventPoints=eventInfo.eventPoints,b.eventInfo.type=eventInfo.type,b.category=category,b.attributes.requestedURL=attributes.requestedURL,b.attributes.errorCode=attributes.errorCode,b.attributes.solutionSpecific=attributes.solutionSpecific,b.attributes.linkedComponent=attributes.linkedComponent,b.attributes.linkedPage=attributes.linkedPage,b.attributes.linkedProduct=attributes.linkedProduct,delete b.attributes.errorCode,delete b.attributes.relatedComponent,delete b.attributes.relatedPageCategory,
delete b.attributes.relatedPageName,delete b.attributes.solutionSpecific,delete b.eventInfo.element,delete b.eventInfo.target,this._parseDataFromEvent(b,e,a,!0),this._logData(b))},_getTrackingOptionsData:function(a){return d(a).data("tracking-options")||null},_getTrackingEventData:function(a){try{var b=JSON.parse(d(a).attr("data-tracking-event"))}catch(c){b=null}return b},_getTrackingComponentData:function(a){try{var b=JSON.parse(d(a).attr("data-tracking-component"))}catch(c){b=null}return b},_getTrackingProducts:function(a){return this._getTrackingProductElements(a).map(this._extractProduct).filter(this._isNotNull)},
_getTrackingProductElements:function(a){var b=[];a=a.find(".ds2-electric-range__content");a.find("[data-tracking-product]").get().forEach(function(a){b.push(a)});return b},_extractProduct:function(a){try{return JSON.parse(a.getAttribute("data-tracking-product"))}catch(b){return null}},_isNotNull:function(a){return null!==a},_addProductsToGlobalTracking:function(a){var b=this._retrieveTrackingConfigurationPage(),c;a.forEach(function(a){a.attributes.mmdr=a.attributes.internalCode;delete a.attributes.internalCode});
b&&((c=b.product)&&0<c.length?this._extendTrackingProducts(c,a):b.product=a)},_retrieveTrackingConfigurationPage:function(){var a=window.trackingConfiguration&&window.trackingConfiguration.digitalData;if(a&&a.activePageIndex)return a.pages[a.activePageIndex]},_extendTrackingProducts:function(a,b){var c=this;b.filter(function(b){return 0===a.filter(c._haveDifferentProductIds(b)).length}).forEach(function(b){a.push(b)})},_haveDifferentProductIds:function(a){return function(b){var c=a&&a.productInfo&&
a.productInfo.productID;b=b&&b.productInfo&&b.productInfo.productID;return null!=c&&null!=b&&c!==b}},_logData:function(a){window.digitals2.tracking.debug&&console.table({"eventInfo.eventName":a.eventInfo.eventName,"eventInfo.eventAction":a.eventInfo.eventAction,"eventInfo.eventPoints":a.eventInfo.eventPoints,"eventInfo.type":a.eventInfo.type,"eventInfo.timeStamp":a.eventInfo.timeStamp,"eventInfo.effect":a.eventInfo.effect,"eventInfo.cause":a.eventInfo.cause,"eventInfo.target":a.eventInfo.target,"eventInfo.element":a.eventInfo.element,
"category.primaryCategory":a.category.primaryCategory,"category.subCategory1":a.category.subCategory1,"category.mmdr":a.category.mmdr,"category.eventType":a.category.eventType,"attributes.requestedURL":a.attributes.requestedURL,"attributes.errorCode":a.attributes.errorCode,"attributes.solutionSpecific.trCarRangeMax":a.attributes.solutionSpecific.trCarRangeMax,"attributes.solutionSpecific.trCarRangeMin":a.attributes.solutionSpecific.trCarRangeMin,"attributes.solutionSpecific.trEmission":a.attributes.solutionSpecific.trEmission,
"attributes.solutionSpecific.trFuelConsumption":a.attributes.solutionSpecific.trFuelConsumption,"attributes.solutionSpecific.trElectricPowerConsumption":a.attributes.solutionSpecific.trElectricPowerConsumption,"attributes.solutionSpecific.trModelName":a.attributes.solutionSpecific.trModelName,"attributes.solutionSpecific.trTopSpeed":a.attributes.solutionSpecific.trTopSpeed,"attributes.solutionSpecific.trNoOfSeats":a.attributes.solutionSpecific.trNoOfSeats,"attributes.solutionSpecific.trEnginePower":a.attributes.solutionSpecific.trEnginePower,
"attributes.solutionSpecific.trSeries":a.attributes.solutionSpecific.trSeries,"attributes.linkedComponent[0].componentInfo":a.attributes.linkedComponent[0].componentInfo,"attributes.linkedPage.pageInfo":a.attributes.linkedPage.pageInfo,"attributes.linkedProduct[0].productInfo":a.attributes.linkedProduct[0].productInfo})}});return function(a,b){d(a).ds2TrackingELectricRange(g.getOptions(b))}});