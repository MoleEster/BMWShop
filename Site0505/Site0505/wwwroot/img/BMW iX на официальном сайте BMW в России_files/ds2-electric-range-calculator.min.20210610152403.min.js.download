define("ds2-electric-range-calculator",["jquery"],function(g){var h=function(){this.settings;this.profileMap;this.HV_DATA="HV";this.FWST_DATA="FWST";this.PRECON_DATA="PRECON";this.cityEvbWltpLowMultiplier=3.09453;this.cityEvbWltpMediumMultiplier=4.75588;this.kmToMileFactor=.62137},d=h.prototype;d.getRange=function(a,c,b,d,f){var k=this,e=g.Deferred(),h=k.validateRequest(a,c,b,d,f);0!==h.length?e.resolve(h):(k.mapProfile(c),g.when(this.init()).done(function(){var c=k.getErwErange(a,d,b,f);c=5*Math.round(c/
5);e.resolve(c)}));return e.promise()};d.validateRequest=function(a,c,b,d,f){var e="";0===a.length&&(e+="Model Range is required; ");if(!Number.isInteger(c)||1>c||5<c)e+="Profile code is not valid; ";if(!Number.isInteger(b)||-10>b||35<b||0!==b%5)e+="Temperatue is not valid; ";this.isBoolean(d)||(e+="Climatisation is not valid; ");this.isBoolean(f)||(e+="Preconditioning is not valid;");return e};d.isBoolean=function(a){return!1===a||!0===a};d.init=function(){var a=this,c=g(location).attr("href").split(".html")[0]+
".erangecalculator.json",b=g.Deferred();g.ajax({url:c,type:"GET",dataType:"json"}).done(function(c){a.settings=c;b.resolve()}).fail(function(a){b.resolve()});return b.promise()};d.mapProfile=function(a){switch(a){case 1:this.profileMap={city:0,countryRoad:1,highway:0};break;case 2:this.profileMap={city:0,countryRoad:.75,highway:.25};break;case 3:this.profileMap={city:0,countryRoad:.5,highway:.5};break;case 4:this.profileMap={city:0,countryRoad:.25,highway:.85};break;case 5:this.profileMap={city:0,
countryRoad:0,highway:1.2};break;default:console.log("The provided profile is not valid!")}};d.getCityEvbCommunication=function(a){a=this.getModelRangeSettings(a);if(null!==a)return(a.evbWltpLow*this.cityEvbWltpLowMultiplier+a.evbWltpMedium*this.cityEvbWltpMediumMultiplier)/(this.cityEvbWltpLowMultiplier+this.cityEvbWltpMediumMultiplier);console.log("City eVB Communication not computed due to invalid modelRangeCode");return 0};d.getCityEvbHv=function(a,c){var b=0;a&&(a=this.getEnvironmentSettings(c,
this.HV_DATA),null!==a&&(b=a.environments.cityEnv));return b};d.getCityEvbFwst=function(a,c){c=this.getEnvironmentSettings(c,this.FWST_DATA);a=this.getModelRangeSettings(a);var b=0;null!==c&&null!==a&&(b=c.environments.cityEnv*a.cxAbasis);return b};d.getCityEvbTotal=function(a,c,b){return this.getCityEvbCommunication(a)+this.getCityEvbHv(c,b)+this.getCityEvbFwst(a,b)};d.getCountryRoadEvbCommunication=function(a){a=this.getModelRangeSettings(a);if(null!==a)return a.evbWltpHigh;console.log("Country Road eVB Communication not computed due to invalid modelRangeCode");
return 0};d.getCountryRoadEvbHv=function(a,c){var b=0;a&&(a=this.getEnvironmentSettings(c,this.HV_DATA),null!==a&&(b=a.environments.countryRoadEnv));return b};d.getCountryRoadEvbFwst=function(a,c){c=this.getEnvironmentSettings(c,this.FWST_DATA);a=this.getModelRangeSettings(a);var b=0;null!==c&&null!==a&&(b=c.environments.countryRoadEnv*a.cxAbasis);return b};d.getCountryRoadEvbTotal=function(a,c,b){return this.getCountryRoadEvbCommunication(a)+this.getCountryRoadEvbHv(c,b)+this.getCountryRoadEvbFwst(a,
b)};d.getHighwayEvbCommunication=function(a){a=this.getModelRangeSettings(a);if(null!==a)return a.evbWltpExtra;console.log("Highway eVB Communication not computed due to invalid modelRangeCode");return 0};d.getHighwayEvbHv=function(a,c){var b=0;a&&(a=this.getEnvironmentSettings(c,this.HV_DATA),null!==a&&(b=a.environments.highwayEnv));return b};d.getHighwayEvbFwst=function(a,c){c=this.getEnvironmentSettings(c,this.FWST_DATA);a=this.getModelRangeSettings(a);var b=0;null!==c&&null!==a&&(b=c.environments.highwayEnv*
a.cxAbasis);return b};d.getHighwayEvbTotal=function(a,c,b){return this.getHighwayEvbCommunication(a)+this.getHighwayEvbHv(c,b)+this.getHighwayEvbFwst(a,b)};d.getEvbPreconditioning=function(a,c,b){return a?0:(a=this.getEnvironmentSettings(b,this.PRECON_DATA),c=this.getModelRangeSettings(c),b=0,null!==a&&null!==c&&(b=a.energy/(1E3*c.netEnergy)*-100),b)};d.getEvbErangeIndicator=function(a,c,b){var d=this.profileMap.city*this.getCityEvbTotal(a,c,b),f=this.profileMap.countryRoad*this.getCountryRoadEvbTotal(a,
c,b);a=this.profileMap.highway*this.getHighwayEvbTotal(a,c,b);return d+f+a};d.getErwErange=function(a,c,b,d){var e=this.getModelRangeSettings(a);return e.evbWltpBc/this.getEvbErangeIndicator(a,c,b)*e.wltpBest*(100+this.getEvbPreconditioning(d,a,b))/100};d.getModelRangeSettings=function(a){var c;void 0!==this.settings&&null!==this.settings&&(c=this.settings.mergedModelRangeCodeResults.find(function(b){return b.rangeCode===a}));return c};d.getEnvironmentSettings=function(a,c){switch(c){case this.HV_DATA:return this.settings.mergedModelHvResults.find(function(b){return b.temperature===
a});case this.FWST_DATA:return this.settings.mergedModelFwstResults.find(function(b){return b.temperature===a});case this.PRECON_DATA:return this.settings.mergedModelPreconditionResults.find(function(b){return b.temperature===a});default:return null}};return h});