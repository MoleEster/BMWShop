define.nextId("ds2-iframe-resizer");
(function(p){function q(b,a,g){"addEventListener"in window?b.addEventListener(a,g,!1):"attachEvent"in window&&b.attachEvent("on"+a,g)}function R(a,d,g){"removeEventListener"in window?a.removeEventListener(d,g,!1):"detachEvent"in window&&a.detachEvent("on"+d,g)}function S(){var a=["moz","webkit","o","ms"],d;for(d=0;d<a.length&&!r;d+=1)r=window[a[d]+"RequestAnimationFrame"];r||h("setup","RequestAnimationFrame not supported")}function T(a){var b="Host page: "+a;window.top!==window.self&&(b=window.parentIFrame&&
window.parentIFrame.getId?window.parentIFrame.getId()+": "+a:"Nested host page: "+a);return b}function h(b,d){C("log",b,d,a[b]?a[b].log:D)}function t(a,d){C("warn",a,d,!0)}function C(a,d,g,c){if(c=!0===c&&"object"===typeof window.console&&window.console[a])c=(c=window.console[a])&&"[object Function]"==={}.toString.call(c);if(c)console[a]("[iFrameSizer]["+T(d)+"]",g)}function U(b){function d(){c("Height");c("Width");G(function(){H(k);I(f);w(f,"resizedCallback",k)},k,"init")}function g(){var b=m.substr(13).split(":");
return{iframe:a[b[0]]&&a[b[0]].iframe,id:b[0],height:b[1],width:b[2],type:b[3]}}function c(b){var c=Number(a[f]["max"+b]),d=Number(a[f]["min"+b]);b=b.toLowerCase();var e=Number(k[b]);h(f,"Checking "+b+" is in range "+d+"-"+c);e<d&&(e=d,h(f,"Set "+b+" to min value"));e>c&&(e=c,h(f,"Set "+b+" to max value"));k[b]=""+e}function x(){function c(){function b(){var a=0,b=!1;for(h(f,"Checking connection is from allowed list of origins: "+e);a<e.length;a++)if(e[a]===d){b=!0;break}return b}function c(){var b=
a[f]&&a[f].remoteHost;h(f,"Checking connection is from: "+b);return d===b}return e.constructor===Array?b():c()}var d=b.origin,e=a[f]&&a[f].checkOrigin;if(e&&"null"!==""+d&&!c())throw Error("Unexpected message received from: "+d+" for "+k.iframe.id+". Message was: "+b.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}function p(){var a=k.type in{"true":1,"false":1,undefined:1};a&&h(f,"Ignoring init message from meta parent page");
return a}function e(a){h(f,"MessageCallback passed: {iframe: "+k.iframe.id+", message: "+a+"}");a={iframe:k.iframe,message:JSON.parse(a)};w(f,"messageCallback",a);h(f,"--")}function y(a,b){E(function(){var c=n;var d=document.body.getBoundingClientRect();var e=k.iframe.getBoundingClientRect();d=JSON.stringify({iframeHeight:e.height,iframeWidth:e.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||
0),offsetTop:parseInt(e.top-d.top,10),offsetLeft:parseInt(e.left-d.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset});c("Send Page Info","pageInfo:"+d,a,b)},32)}function V(){function b(b,e){function f(){a[c]?y(a[c].iframe,c):d()}["scroll","resize"].forEach(function(a){h(c,b+a+" listener for sendPageInfo");e(window,a,f)})}function d(){b("Remove ",R)}var c=f;b("Add ",q);a[c]&&(a[c].stopPageInfo=d)}function W(){var a=!0;null===k.iframe&&(t(f,"IFrame ("+k.id+") not found"),a=!1);return a}
function r(a){a=a.getBoundingClientRect();J(f);return{x:Math.floor(Number(a.left)+Number(l.x)),y:Math.floor(Number(a.top)+Number(l.y))}}function u(a){var b=a?r(k.iframe):{x:0,y:0},c={x:Number(k.width)+b.x,y:Number(k.height)+b.y};h(f,"Reposition requested from iFrame (offset x:"+b.x+" y:"+b.y+")");if(window.top!==window.self)if(window.parentIFrame)window.parentIFrame["scrollTo"+(a?"Offset":"")](c.x,c.y);else t(f,"Unable to scroll to requested position, window.parentIFrame not found");else l=c,v(),
h(f,"--")}function v(){!1!==w(f,"scrollCallback",l)?I(f):l=null}function z(a){a=a.split("#")[1]||"";var b=decodeURIComponent(a);(b=document.getElementById(b)||document.getElementsByName(b)[0])?(b=r(b),h(f,"Moving to in page link (#"+a+") at x: "+b.x+" y: "+b.y),l={x:b.x,y:b.y},v(),h(f,"--")):window.top!==window.self?window.parentIFrame?window.parentIFrame.moveToAnchor(a):h(f,"In page link #"+a+" not found and window.parentIFrame not found"):h(f,"In page link #"+a+" not found")}function A(b){var c=
!0;a[b]||(c=!1,t(k.type+" No settings for "+b+". Message was: "+m));return c}function B(){for(var b in a)n("iFrame requested init",F(b),document.getElementById(b),b)}var m=b.data,k={},f=null;if("[iFrameResizerChild]Ready"===m)B();else if("[iFrameSizer]"===(""+m).substr(0,13)&&m.substr(13).split(":")[0]in a){if(k=g(),f=k.id,a[f]&&(a[f].loaded=!0),!p()&&A(f)&&(h(f,"Received: "+m),W()&&x()))switch(a[f]&&a[f].firstRun&&a[f]&&(a[f].firstRun=!1),k.type){case "close":a[f].closeRequestCallback?w(f,"closeRequestCallback",
a[f].iframe):K(k.iframe);break;case "message":e(m.substr(m.indexOf(":")+7+6));break;case "scrollTo":u(!1);break;case "scrollToOffset":u(!0);break;case "pageInfo":y(a[f]&&a[f].iframe,f);V();break;case "pageInfoStop":a[f]&&a[f].stopPageInfo&&(a[f].stopPageInfo(),delete a[f].stopPageInfo);break;case "inPageLink":z(m.substr(m.indexOf(":")+7+9));break;case "reset":L(k);break;case "init":d();w(f,"initCallback",k.iframe);break;default:d()}}else C("info",f,"Ignored: "+m,a[f]?a[f].log:D)}function w(b,d,g){var c=
null;if(a[b])if(c=a[b][d],"function"===typeof c)c=c(g);else throw new TypeError(d+" on iFrame["+b+"] is not a function");return c}function K(b){var d=b.id;h(d,"Removing iFrame: "+d);b.parentNode&&b.parentNode.removeChild(b);w(d,"closedCallback",d);h(d,"--");delete a[d]}function J(a){null===l&&(l={x:window.pageXOffset!==p?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==p?window.pageYOffset:document.documentElement.scrollTop},h(a,"Get page position: "+l.x+","+l.y))}function I(a){null!==
l&&(window.scrollTo(l.x,l.y),h(a,"Set page position: "+l.x+","+l.y),l=null)}function L(a){h(a.id,"Size reset requested by "+("init"===a.type?"host page":"iFrame"));J(a.id);G(function(){H(a);n("reset","reset",a.iframe,a.id)},a,"reset")}function H(b){function d(a){var c=/%$/.test(b[a])?"":"px";b.iframe.style[a]=b[a]+c;h(b.id,"IFrame ("+g+") "+a+" set to "+b[a]+"px");M||"0"!==b[a]||(M=!0,h(g,"Hidden iFrame detected, creating visibility listener"),X())}var g=b.iframe.id;a[g]&&(a[g].sizeHeight&&d("height"),
a[g].sizeWidth&&d("width"))}function G(a,d,g){g!==d.type&&r?(h(d.id,"Requesting animation frame"),r(a)):a()}function n(b,d,g,c,x){function l(){var e=a[c]&&a[c].targetOrigin;h(c,"["+b+"] Sending msg to iframe["+c+"] ("+d+") targetOrigin: "+e);g.contentWindow.postMessage("[iFrameSizer]"+d,e)}function e(){function b(){!a[c]||a[c].loaded||y||(y=!0,t(c,"IFrame has not responded within "+a[c].warningTimeout/1E3+" seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame. This message can be ingored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning."))}
x&&a[c]&&a[c].warningTimeout&&(a[c].msgTimeout=setTimeout(b,a[c].warningTimeout))}var y=!1;c=c||g.id;a[c]&&(g&&"contentWindow"in g&&null!==g.contentWindow?l():t(c,"["+b+"] IFrame("+c+") not found"),e())}function F(b){b=b+":"+a[b].bodyMarginV1+":"+a[b].sizeWidth+":"+a[b].log+":"+a[b].interval+":"+a[b].enablePublicMethods+":"+a[b].autoResize+":"+a[b].bodyMargin+":"+a[b].heightCalculationMethod+":"+a[b].bodyBackground+":"+a[b].bodyPadding+":"+a[b].tolerance+":"+a[b].inPageLinks+":"+a[b].resizeFrom+":"+
a[b].widthCalculationMethod;window.consentcontroller&&window.consentcontroller.api&&(window.consentcontroller.api.isRegulationAccepted&&(u=window.consentcontroller.api.isRegulationAccepted()),window.consentcontroller.api.getRegulationType&&(b=b+":"+window.consentcontroller.api.getRegulationType()),b=b+":"+u);return b}function N(b,d){function g(){function c(c){Infinity!==a[e][c]&&0!==a[e][c]&&(b.style[c]=a[e][c]+"px",h(e,"Set "+c+" \x3d "+a[e][c]+"px"))}function d(b){if(a[e]["min"+b]>a[e]["max"+b])throw Error("Value for min"+
b+" can not be greater than max"+b);}d("Height");d("Width");c("maxHeight");c("minHeight");c("maxWidth");c("minWidth")}function c(){Function.prototype.bind&&a[e]&&(a[e].iframe.iFrameResizer={close:K.bind(null,a[e].iframe),resize:n.bind(null,"Window resize","resize",a[e].iframe),moveToAnchor:function(b){n("Move to anchor","moveToAnchor:"+b,a[e].iframe,e)},sendMessage:function(b){b=JSON.stringify(b);n("Send Message","message:"+b,a[e].iframe,e)}})}function x(c){function d(){n("iFrame.onload",F(e),b,p,
!0);var c=a[e]&&a[e].heightCalculationMethod in Y;a[e]&&a[e].firstRun||!c||L({iframe:b,height:"100%",width:"100%",type:"init"})}a[e].firstRun=!0;q(b,"load",function(){b.style&&b.style.height&&(b.style.height="");setTimeout(d,128)});n("init",c,b,p,!0)}function l(c){c=c||{};a[e]={firstRun:!0,iframe:b,remoteHost:b.src.split("/").slice(0,3).join("/")};if("object"!==typeof c)throw new TypeError("Options is not an object");for(var d in v)v.hasOwnProperty(d)&&(a[e][d]=c.hasOwnProperty(d)?c[d]:v[d]);a[e]&&
(d=a[e],!0===a[e].checkOrigin?(c=a[e].remoteHost,c=""===c||"file://"===c?"*":c):c="*",d.targetOrigin=c)}var e=function(a){""===a&&(a=d&&d.id||v.id+O++,null!==document.getElementById(a)&&(a+=O++),b.id=a,D=(d||{}).log,h(a,"Added missing iframe ID: "+a+" ("+b.src+")"));return a}(b.id);if(e in a&&"iFrameResizer"in b)t(e,"Ignored iFrame, already setup.");else{l(d);h(e,"IFrame scrolling "+(a[e]&&a[e].scrolling?"enabled":"disabled")+" for "+e);b.style.overflow=!1===(a[e]&&a[e].scrolling)?"hidden":"auto";
switch(a[e]&&a[e].scrolling){case !0:b.scrolling="yes";break;case !1:b.scrolling="no";break;default:b.scrolling=a[e]?a[e].scrolling:"no"}g();if("number"===typeof(a[e]&&a[e].bodyMargin)||"0"===(a[e]&&a[e].bodyMargin))a[e].bodyMarginV1=a[e].bodyMargin,a[e].bodyMargin=""+a[e].bodyMargin+"px";x(F(e));c()}}function E(a,d){null===z&&(z=setTimeout(function(){z=null;a()},d))}function X(){function b(){for(var b in a)!a[b]||null===a[b].iframe.offsetParent||"0px"!==(a[b]&&a[b].iframe.style.height)&&"0px"!==
(a[b]&&a[b].iframe.style.width)||n("Visibility change","resize",a[b].iframe,b)}function d(a){h("window","Mutation observed: "+a[0].target+" "+a[0].type);E(b,16)}function g(){var a=document.querySelector("body");(new c(d)).observe(a,{attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0})}var c=window.MutationObserver||window.WebKitMutationObserver;c&&g()}function A(a){h("window","Trigger event: "+a);E(function(){P("Window "+a,"resize")},16)}function Q(){function a(){P("Tab Visable",
"resize")}"hidden"!==document.visibilityState&&(h("document","Trigger event: Visiblity change"),E(a,16))}function P(b,d){for(var g in a)a[g]&&"parent"===a[g].resizeFrom&&a[g].autoResize&&!a[g].firstRun&&n(b,d,document.getElementById(g),g)}function Z(){window.consentcontroller&&window.consentcontroller.api&&window.consentcontroller.api.registerOnConsentChange(function(){if(window.consentcontroller.api.isRegulationAccepted()!=u){u=window.consentcontroller.api.isRegulationAccepted();for(var b in a){var d=
a[b].iframe;n("userConsentChanged",d.id+":"+u,d,p,!0)}}})}function aa(){q(window,"message",U);q(window,"resize",function(){A("resize")});q(document,"visibilitychange",Q);q(document,"-webkit-visibilitychange",Q);q(window,"focusin",function(){A("focus")});q(window,"focus",function(){A("focus")})}function B(){function a(a,b){if(b){if(!b.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==b.tagName.toUpperCase())throw new TypeError("Expected \x3cIFRAME\x3e tag, found \x3c"+
b.tagName+"\x3e");N(b,a);d.push(b)}}var d;S();aa();Z();return function(b,c){d=[];b&&b.enablePublicMethods&&t("enablePublicMethods option has been removed, public methods are now always available in the iFrame");switch(typeof c){case "undefined":case "string":Array.prototype.forEach.call(document.querySelectorAll(c||"iframe"),a.bind(p,b));break;case "object":a(b,c);break;default:throw new TypeError("Unexpected data type ("+typeof c+")");}return d}}function ba(b){b.fn?b.fn.iFrameResize||(b.fn.iFrameResize=
function(a){return this.filter("iframe").each(function(b,c){N(c,a)}).end()}):C("info","","Unable to bind to jQuery, it is not fully loaded.",a[""]?a[""].log:D)}if("undefined"!==typeof window){var O=0,D=!1,M=!1,l=null,r=window.requestAnimationFrame,Y={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},a={},z=null,u=null,v={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",
interval:32,log:!1,maxHeight:Infinity,maxWidth:Infinity,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,warningTimeout:5E3,tolerance:0,widthCalculationMethod:"scroll",closedCallback:function(){},initCallback:function(){},messageCallback:function(){t("MessageCallback function not defined")},resizedCallback:function(){},scrollCallback:function(){return!0}};window.jQuery&&ba(window.jQuery);"function"===typeof define&&define.amd?define([],B):"object"===typeof module&&
"object"===typeof module.exports?module.exports=B():window.iFrameResize=window.iFrameResize||B()}})();